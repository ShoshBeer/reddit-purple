chrome.runtime.onInstalled.addListener((()=>{chrome.action.setBadgeText({text:"OFF"})})),chrome.webNavigation.onCompleted.addListener((e=>{const t=e.tabId;chrome.storage.session.get((function(e){chrome.storage.session.set({...e,[t]:!1})}))})),chrome.webNavigation.onCompleted.addListener((e=>{chrome.scripting.executeScript({target:{tabId:e.tabId},files:["./inject_script.js"]}).then((()=>{chrome.scripting.executeScript({target:{tabId:e.tabId},files:["./foreground.bundle.js"]})}))}),{url:[{urlMatches:"reddit.com/r/[^/]+/comments/[^/]+"}]}),chrome.storage.session.setAccessLevel({accessLevel:"TRUSTED_AND_UNTRUSTED_CONTEXTS"}),chrome.runtime.onMessage.addListener((async e=>{const[t]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0}),s=await chrome.storage.sync.get({minimum:10});if(chrome.storage.session.get(t.url).then((e=>{e[t.url]>=s.minimum&&chrome.action.setBadgeText({tabId:t.id,text:"ON"})})),"toggle"===e.action&&e.target===t.id){const e=!0!==(await chrome.storage.session.get({[t.id]:!1}))[t.id];!0===e?(await chrome.scripting.insertCSS({files:["displayPosts.css"],target:{tabId:t.id}}),chrome.storage.session.get((function(e){chrome.storage.session.set({...e,[t.id]:!0})}))):!1===e&&(await chrome.scripting.removeCSS({files:["displayPosts.css"],target:{tabId:t.id}}),chrome.storage.session.get((function(e){chrome.storage.session.set({...e,[t.id]:!1})})))}})),chrome.runtime.onMessage.addListener((async e=>{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0}),s=await chrome.storage.sync.get({minimum:10});e[t.url]>=s.minimum&&chrome.action.setBadgeText({tabId:t.id,text:"ON"})}));