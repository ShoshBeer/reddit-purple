async function getPostObjects(e){let t=[];const a=e.map((async e=>(void 0===e&&console.log("this is undefined for some reason"),await fetch(e)))),r=await Promise.allSettled(a);return(await Promise.all(r.filter(((a,r)=>"fulfilled"===a.status&&!0===a.value.ok&&t.push(e[r]))).map((e=>e.value.json())))).filter((e=>2===e.length)).map(((e,a)=>{const{title:r,author:o,score:i,subreddit_name_prefixed:n,selftext:s,created_utc:l,url:d,permalink:c,secure_media_embed:g}=e[0].data.children[0].data;return{title:r,author:o,score:i,subreddit_name_prefixed:n,selftext:s,comments:e[1].data.children.map((e=>[e.data.body,e.data.author,e.data.score,e.data.total_awards_received])),url:d,created_utc:l,secure_media_embed:g,jsonlink:t[a],permalink:c}}))}chrome.runtime.onMessage.addListener((async(e,t)=>{console.log("Service Worker recieved Message: ",e.type,"\nFrom Sender: ",t.id),"storeLinks"===e.type&&(console.log("Trying to store links: ",{[t.tab.id]:{url:e.url,links:e.links}}),chrome.storage.local.set({[t.tab.id]:{url:e.url,links:e.links}})),"doneCheck"===e.type&&chrome.storage.local.get(t.tab.id.toString()).then((e=>{console.log("Result of get: ",e,"\nTrying to set: ",{...e[t.tab.id.toString()],done:!0}),chrome.storage.local.set({[t.tab.id]:{...e[t.tab.id.toString()],done:!0}})})),"startCheck"===e.type&&await chrome.storage.local.get(t.tab.id.toString()).then((e=>{console.log("Starting Check. \nSetting Done: false \nTrying to set: ",{...e[t.tab.id.toString()],done:!0}),chrome.storage.local.set({[t.tab.id]:{...e[t.tab.id.toString()],done:!1}})}))})),chrome.webNavigation.onCompleted.addListener((e=>{chrome.scripting.executeScript({target:{tabId:e.tabId},files:["./inject_script.js"]}).then((()=>{chrome.scripting.executeScript({target:{tabId:e.tabId},files:["./foreground.bundle.js"]})}))}),{url:[{urlMatches:"reddit.com/r/[^/]+/comments/[^/]+"}]});